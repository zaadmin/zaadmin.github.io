<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>项目搭建 | xiaoA&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="web前端学习与总结">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.d91d584c.css" as="style"><link rel="preload" href="/assets/js/app.1d277669.js" as="script"><link rel="preload" href="/assets/js/2.fc76d935.js" as="script"><link rel="preload" href="/assets/js/38.899dd51b.js" as="script"><link rel="prefetch" href="/assets/js/10.305bfdcb.js"><link rel="prefetch" href="/assets/js/100.2337461d.js"><link rel="prefetch" href="/assets/js/101.4bb117d2.js"><link rel="prefetch" href="/assets/js/102.d4f2fe45.js"><link rel="prefetch" href="/assets/js/103.06c4f7bb.js"><link rel="prefetch" href="/assets/js/104.e550117a.js"><link rel="prefetch" href="/assets/js/105.36c5e2f4.js"><link rel="prefetch" href="/assets/js/106.4f564d60.js"><link rel="prefetch" href="/assets/js/107.87bc2873.js"><link rel="prefetch" href="/assets/js/108.8bfd62b8.js"><link rel="prefetch" href="/assets/js/109.0ddc8bc4.js"><link rel="prefetch" href="/assets/js/11.54de532c.js"><link rel="prefetch" href="/assets/js/110.4e0e9283.js"><link rel="prefetch" href="/assets/js/111.75c3a620.js"><link rel="prefetch" href="/assets/js/112.a99d30c5.js"><link rel="prefetch" href="/assets/js/113.89c504df.js"><link rel="prefetch" href="/assets/js/114.a058624e.js"><link rel="prefetch" href="/assets/js/115.74d8208e.js"><link rel="prefetch" href="/assets/js/116.434c7d04.js"><link rel="prefetch" href="/assets/js/117.7b9e1f96.js"><link rel="prefetch" href="/assets/js/118.bd4a2a96.js"><link rel="prefetch" href="/assets/js/119.e03f9f3d.js"><link rel="prefetch" href="/assets/js/12.712e6593.js"><link rel="prefetch" href="/assets/js/120.798bb86e.js"><link rel="prefetch" href="/assets/js/121.e8d91f1a.js"><link rel="prefetch" href="/assets/js/122.55c56386.js"><link rel="prefetch" href="/assets/js/123.6f3c2bd6.js"><link rel="prefetch" href="/assets/js/124.389208e9.js"><link rel="prefetch" href="/assets/js/125.f71d6639.js"><link rel="prefetch" href="/assets/js/126.9b5419b0.js"><link rel="prefetch" href="/assets/js/127.21a2b2a5.js"><link rel="prefetch" href="/assets/js/128.fa170a20.js"><link rel="prefetch" href="/assets/js/129.02f789be.js"><link rel="prefetch" href="/assets/js/13.ad20f874.js"><link rel="prefetch" href="/assets/js/130.a7f2181b.js"><link rel="prefetch" href="/assets/js/131.2c5de31a.js"><link rel="prefetch" href="/assets/js/132.8d43b019.js"><link rel="prefetch" href="/assets/js/133.f11275d2.js"><link rel="prefetch" href="/assets/js/134.490e1126.js"><link rel="prefetch" href="/assets/js/135.8bd08020.js"><link rel="prefetch" href="/assets/js/136.fb7dd4b4.js"><link rel="prefetch" href="/assets/js/137.f2862c44.js"><link rel="prefetch" href="/assets/js/138.646bb5f3.js"><link rel="prefetch" href="/assets/js/139.cfb671a4.js"><link rel="prefetch" href="/assets/js/14.fb2ec3e2.js"><link rel="prefetch" href="/assets/js/140.51c608ac.js"><link rel="prefetch" href="/assets/js/141.c0f7bade.js"><link rel="prefetch" href="/assets/js/142.a9aad4a0.js"><link rel="prefetch" href="/assets/js/143.ff9a3103.js"><link rel="prefetch" href="/assets/js/144.0693f293.js"><link rel="prefetch" href="/assets/js/145.53287ee9.js"><link rel="prefetch" href="/assets/js/146.9beba97f.js"><link rel="prefetch" href="/assets/js/147.eb9b0186.js"><link rel="prefetch" href="/assets/js/148.58c8f044.js"><link rel="prefetch" href="/assets/js/149.b3563000.js"><link rel="prefetch" href="/assets/js/15.6b24d205.js"><link rel="prefetch" href="/assets/js/150.fad52db5.js"><link rel="prefetch" href="/assets/js/151.019eb432.js"><link rel="prefetch" href="/assets/js/152.14a14998.js"><link rel="prefetch" href="/assets/js/153.fa08d32b.js"><link rel="prefetch" href="/assets/js/154.6cd5a98b.js"><link rel="prefetch" href="/assets/js/155.adc8d294.js"><link rel="prefetch" href="/assets/js/16.857db591.js"><link rel="prefetch" href="/assets/js/17.276ab9a7.js"><link rel="prefetch" href="/assets/js/18.356779a8.js"><link rel="prefetch" href="/assets/js/19.d898beec.js"><link rel="prefetch" href="/assets/js/20.69fdf40f.js"><link rel="prefetch" href="/assets/js/21.7c5d919c.js"><link rel="prefetch" href="/assets/js/22.ebaaa5bf.js"><link rel="prefetch" href="/assets/js/23.a4c3f297.js"><link rel="prefetch" href="/assets/js/24.d440b96d.js"><link rel="prefetch" href="/assets/js/25.df612d69.js"><link rel="prefetch" href="/assets/js/26.6e771d0b.js"><link rel="prefetch" href="/assets/js/27.e8e5879b.js"><link rel="prefetch" href="/assets/js/28.c0f4deae.js"><link rel="prefetch" href="/assets/js/29.b640c1fa.js"><link rel="prefetch" href="/assets/js/3.bc84b51e.js"><link rel="prefetch" href="/assets/js/30.ddfbc72f.js"><link rel="prefetch" href="/assets/js/31.48528e07.js"><link rel="prefetch" href="/assets/js/32.3dcfc1f6.js"><link rel="prefetch" href="/assets/js/33.e0105339.js"><link rel="prefetch" href="/assets/js/34.4a8c988b.js"><link rel="prefetch" href="/assets/js/35.41248689.js"><link rel="prefetch" href="/assets/js/36.7ffcd2f7.js"><link rel="prefetch" href="/assets/js/37.c7ea0179.js"><link rel="prefetch" href="/assets/js/39.84f84822.js"><link rel="prefetch" href="/assets/js/4.396951eb.js"><link rel="prefetch" href="/assets/js/40.cc56565b.js"><link rel="prefetch" href="/assets/js/41.b6b08b2e.js"><link rel="prefetch" href="/assets/js/42.f972a348.js"><link rel="prefetch" href="/assets/js/43.b813a2e2.js"><link rel="prefetch" href="/assets/js/44.fcef3f8a.js"><link rel="prefetch" href="/assets/js/45.b1a79c72.js"><link rel="prefetch" href="/assets/js/46.8f8b63e8.js"><link rel="prefetch" href="/assets/js/47.8d4801dc.js"><link rel="prefetch" href="/assets/js/48.85dfa49b.js"><link rel="prefetch" href="/assets/js/49.dbbf3aa9.js"><link rel="prefetch" href="/assets/js/5.0de5baa9.js"><link rel="prefetch" href="/assets/js/50.50b8dd94.js"><link rel="prefetch" href="/assets/js/51.29abd20f.js"><link rel="prefetch" href="/assets/js/52.d1189733.js"><link rel="prefetch" href="/assets/js/53.2e5ee001.js"><link rel="prefetch" href="/assets/js/54.acd8e1ba.js"><link rel="prefetch" href="/assets/js/55.f6758e2f.js"><link rel="prefetch" href="/assets/js/56.fbf71a8e.js"><link rel="prefetch" href="/assets/js/57.43f05f61.js"><link rel="prefetch" href="/assets/js/58.e55a3bdd.js"><link rel="prefetch" href="/assets/js/59.25c810d3.js"><link rel="prefetch" href="/assets/js/6.7f1d75c9.js"><link rel="prefetch" href="/assets/js/60.1aa0bea4.js"><link rel="prefetch" href="/assets/js/61.15c756e9.js"><link rel="prefetch" href="/assets/js/62.3b049ade.js"><link rel="prefetch" href="/assets/js/63.3acf6f60.js"><link rel="prefetch" href="/assets/js/64.b6dcb112.js"><link rel="prefetch" href="/assets/js/65.25ce0edb.js"><link rel="prefetch" href="/assets/js/66.7de6f1c2.js"><link rel="prefetch" href="/assets/js/67.fe35124d.js"><link rel="prefetch" href="/assets/js/68.64f2dac1.js"><link rel="prefetch" href="/assets/js/69.950b5e8e.js"><link rel="prefetch" href="/assets/js/7.69bc1b31.js"><link rel="prefetch" href="/assets/js/70.d3b81f9b.js"><link rel="prefetch" href="/assets/js/71.34352887.js"><link rel="prefetch" href="/assets/js/72.cf1db10c.js"><link rel="prefetch" href="/assets/js/73.0814a227.js"><link rel="prefetch" href="/assets/js/74.273476ac.js"><link rel="prefetch" href="/assets/js/75.1c3fddf8.js"><link rel="prefetch" href="/assets/js/76.6d0bb6ec.js"><link rel="prefetch" href="/assets/js/77.5875ec51.js"><link rel="prefetch" href="/assets/js/78.d7c539e6.js"><link rel="prefetch" href="/assets/js/79.66830a7d.js"><link rel="prefetch" href="/assets/js/8.45ecc69e.js"><link rel="prefetch" href="/assets/js/80.db81f64f.js"><link rel="prefetch" href="/assets/js/81.2c3c3a06.js"><link rel="prefetch" href="/assets/js/82.f98739b4.js"><link rel="prefetch" href="/assets/js/83.e287ddb2.js"><link rel="prefetch" href="/assets/js/84.61e566d2.js"><link rel="prefetch" href="/assets/js/85.5fb377e4.js"><link rel="prefetch" href="/assets/js/86.58aed56c.js"><link rel="prefetch" href="/assets/js/87.e3148a1a.js"><link rel="prefetch" href="/assets/js/88.e6cb060b.js"><link rel="prefetch" href="/assets/js/89.72f209bc.js"><link rel="prefetch" href="/assets/js/9.9b116447.js"><link rel="prefetch" href="/assets/js/90.75e3b7fd.js"><link rel="prefetch" href="/assets/js/91.58e9502f.js"><link rel="prefetch" href="/assets/js/92.3d6f9f3a.js"><link rel="prefetch" href="/assets/js/93.eab54d64.js"><link rel="prefetch" href="/assets/js/94.80fd0ef5.js"><link rel="prefetch" href="/assets/js/95.2e4a86ae.js"><link rel="prefetch" href="/assets/js/96.6438d580.js"><link rel="prefetch" href="/assets/js/97.c8e22d62.js"><link rel="prefetch" href="/assets/js/98.feedfcea.js"><link rel="prefetch" href="/assets/js/99.7bb92c1f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d91d584c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu only-sidebarItem"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="xiaoA's blog" class="logo"> <span class="site-name can-hide">xiaoA's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript/" class="nav-link">《TypeScript》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/note/node/" class="nav-link">《node》</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="布局" class="dropdown-title"><a href="/ui/" class="link-title">布局</a> <span class="title" style="display:none;">布局</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><a href="/network/" class="link-title">网络</a> <span class="title" style="display:none;">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/5826d5/" class="nav-link">http1.X与http2.0</a></li><li class="dropdown-item"><!----> <a href="/pages/dd2bf3/" class="nav-link">缓存</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微前端" class="dropdown-title"><a href="/network/" class="link-title">微前端</a> <span class="title" style="display:none;">微前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/a17ad1/" class="nav-link">项目搭建</a></li></ul></div></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript/" class="nav-link">《TypeScript》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/note/node/" class="nav-link">《node》</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="布局" class="dropdown-title"><a href="/ui/" class="link-title">布局</a> <span class="title" style="display:none;">布局</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><a href="/network/" class="link-title">网络</a> <span class="title" style="display:none;">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/5826d5/" class="nav-link">http1.X与http2.0</a></li><li class="dropdown-item"><!----> <a href="/pages/dd2bf3/" class="nav-link">缓存</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微前端" class="dropdown-title"><a href="/network/" class="link-title">微前端</a> <span class="title" style="display:none;">微前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/a17ad1/" class="nav-link">项目搭建</a></li></ul></div></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/pages/5abf96/" aria-current="page" class="active sidebar-link">项目搭建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/5abf96/#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header level2"><a href="/pages/5abf96/#微前端" class="sidebar-link">微前端</a></li><li class="sidebar-sub-header level2"><a href="/pages/5abf96/#qiankun" class="sidebar-link">qiankun</a></li><li class="sidebar-sub-header level2"><a href="/pages/5abf96/#实践" class="sidebar-link">实践</a></li></ul></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E5%BE%AE%E5%89%8D%E7%AB%AF" title="分类" data-v-06225672>微前端</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/zaadmin" target="_blank" title="作者" class="beLink" data-v-06225672>ai.zhang</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-09-05</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">项目搭建<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>由于公司业务不断扩张，原本的后台管理系统显得越来越臃肿，每次运行打包都要好几分钟，极大的耽误了开发调试的时间。起初的做法是按照业务将项目进行了拆包，所有的项目都放在服务器同一文件夹下，父项目将自身实例，路由，状态管理等挂载window下供子项目使用，父子项目共用实例。生产模式下父项目加载的时候会去读取其它子项目的html文件，将相应的js及css文件均加载进来，本地调试模式的时候各子项目会读取线上某个环境父项目的index.html作为自己的模板从而运行起来。这种做法的坏处就是子项目是无法独立运行、独立发布的，于是新项目搭建的时候公司采用了微前端。</p> <h2 id="微前端"><a href="#微前端" class="header-anchor">#</a> 微前端</h2> <p>微服务是面向服务架构（SOA）的一种变体，把应用程序设计成一系列松耦合的细粒度服务，并通过轻量级的通信协议组织起来，具体地，将应用构建成一组小型服务。这些服务都能够独立部署、独立扩展，每个服务都具有稳固的模块边界，甚至允许使用不同的编程语言来编写不同服务，也可以由不同的团队来管理。</p> <p>当公司业务需求越来越多的时候，项目就会越来越庞大，后续如果想对项目进行重构亦或是某块大的业务需求想要独立出来都是很困难的事情，再或者有了新的更好的技术框架，也是很难再去改造之前的项目。这种时候微前端的优势就很明显了，将庞大的块拆成一小块一小块，分而治之，关键的优势在于：</p> <ul><li>技术栈无关
主框架不限制接入应用的技术栈，微应用具备完全自主权</li> <li>独立开发、独立部署
微应用仓库独立，前后端可独立开发，部署完成后主框架自动完成同步更新</li> <li>增量升级
在面对各种复杂场景时，我们通常很难对一个已经存在的系统做全量的技术栈升级或重构，而微前端是一种非常好的实施渐进式重构的手段和策略</li> <li>独立运行时每个微应用之间状态隔离，运行时状态不共享
本文微前端的实现采用了qiankun。</li></ul> <h2 id="qiankun"><a href="#qiankun" class="header-anchor">#</a> qiankun</h2> <p>qiankun 是一个生产可用的微前端框架，它基于 single-spa，具备 js 沙箱、样式隔离、HTML Loader、预加载 等微前端系统所需的能力。qiankun 可以用于任意 js 框架，微应用接入像嵌入一个 iframe 系统一样简单。</p> <p>接下来简单搭建下基于qiankun的微前端。</p> <h2 id="实践"><a href="#实践" class="header-anchor">#</a> 实践</h2> <p>首先新建两个vue项目，一个作为主应用，一个作为微应用。</p> <p>主应用</p> <p>接着我们首先改造主应用：</p> <p>1、安装qiankun</p> <p>yarn add qiankun
2、在主应用中注册微应用</p> <p>首先在src目录下新增micro目录，新增app.js用来存放需要注册的微应用。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>src<span class="token operator">/</span>micro<span class="token operator">/</span>app<span class="token punctuation">.</span>js

<span class="token keyword">const</span> <span class="token function-variable function">getActiveRule</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">hash</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">location</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> apps <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'sub-app1'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">'//localhost:8081'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">container</span><span class="token operator">:</span> <span class="token string">'#sub-container'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">activeRule</span><span class="token operator">:</span> <span class="token function">getActiveRule</span><span class="token punctuation">(</span><span class="token string">'#/sub1'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> apps
name <span class="token operator">-</span> string <span class="token operator">-</span> 必选，微应用的名称，微应用之间需要保持唯一。
entry <span class="token operator">-</span> string <span class="token operator">|</span> <span class="token punctuation">{</span> scripts<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> styles<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> html<span class="token operator">?</span><span class="token operator">:</span> string <span class="token punctuation">}</span> <span class="token operator">-</span> 必选，微应用的入口。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>配置为字符串时，表示微应用的访问地址，上述示例只配置了本地访问的地址，实际项目中需要根据环境配置微应用的访问地址。
配置为对象时，html的值是微应用的html内容字符串，而不是微应用的而访问地址。微应用的publicPath将会被设置为/。（这种方式没有尝试过，有兴趣的小伙伴可以试试~）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>container <span class="token operator">-</span> string <span class="token operator">|</span> HTMLElement <span class="token operator">-</span> 必选，微应用的容器节点的选择器或者Element实例。上述示例即代表id为<span class="token string">'sub-container'</span><span class="token literal-property property">的容器节点，也可以写成container</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#sub-container'</span><span class="token punctuation">)</span>。
activeRule <span class="token operator">-</span> string <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">location</span><span class="token operator">:</span> Location</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> boolean <span class="token operator">|</span> Array<span class="token operator">&lt;</span>string <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">location</span><span class="token operator">:</span> Location</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> boolean<span class="token operator">&gt;</span> <span class="token operator">-</span> 必选，微应用的激活规则。
<span class="token literal-property property">支持直接配置字符串或字符串数组，如activeRule</span><span class="token operator">:</span> <span class="token string">'/sub1'</span> 或 activeRule<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'/sub1'</span><span class="token punctuation">,</span> <span class="token string">'/sub2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>支持配置一个active function函数或者一组active function。函数会传入当前location作为参数，函数返回true时表明当前微应用会被激活。如location =&gt; location.pathname.startsWith('/app1')</p> <p>本文采用的是hash模式，所以写成activeRule: getActiveRule('#/sub1'),也可以直接写activeRule: '#/sub1',但是如果主应用是 history 模式或者主应用部署在非根目录，这样写不会生效。</p> <p>loader - (loading: boolean) =&gt; void - 可选，loading状态发生变化时会调用的方法。
props - object - 可选，主应用需要传递给微应用的数据。可用来进行项目间的通信。（譬如，传递store，router，请求封装的方法等）
接下来，在micro下新增index.js用来注册我们的微应用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>src<span class="token operator">/</span>micro<span class="token operator">/</span>index<span class="token punctuation">.</span>js

<span class="token keyword">import</span> <span class="token punctuation">{</span>
    registerMicroApps<span class="token punctuation">,</span>
    addGlobalUncaughtErrorHandler<span class="token punctuation">,</span>
    start<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;qiankun&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> apps <span class="token keyword">from</span> <span class="token string">'./app'</span>

<span class="token function">registerMicroApps</span><span class="token punctuation">(</span>apps<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">beforeLoad</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'before load'</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">afterMount</span><span class="token operator">:</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;after mount&quot;</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">addGlobalUncaughtErrorHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token string">'event'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> msg <span class="token punctuation">}</span> <span class="token operator">=</span> event
    <span class="token keyword">if</span> <span class="token punctuation">(</span>msg <span class="token operator">&amp;&amp;</span> msg<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;died in status LOADING_SOURCE_CODE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;微应用加载失败，请检查应用是否可运行&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> start<span class="token punctuation">;</span>
<span class="token function">registerMicroApps</span><span class="token punctuation">(</span>apps<span class="token punctuation">,</span> lifeCycles<span class="token operator">?</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>apps - Array<RegistrableApp> - 必选，微应用的一些注册信息。
lifeCycles - LifeCycles - 可选，全局的微应用声明周期钩子。 该API是用来注册微应用的基础配置信息。当浏览器的url发生变化时，会自动检查每一个微应用注册的activeRule规则，符合规则的应用将会被自动激活。
addGlobalUncaughtErrorHandler(handler)</RegistrableApp></p> <p>handler - (...args: any[]) =&gt; void - 必选 该API是用来添加全局的未捕获异常处理器。
start(opts?)</p> <p>opts - Options - 可选 具体参数可参考官方文档 该API是用来启动qiankun的。
3、启动 首先需要改造下我们的App.vue，新增一个id为“sub-container“的节点</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>src<span class="token operator">/</span>App<span class="token punctuation">.</span>vue

<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;nav&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>router<span class="token operator">-</span>link to<span class="token operator">=</span><span class="token string">&quot;/home&quot;</span><span class="token operator">&gt;</span>Home<span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">&gt;</span> <span class="token operator">|</span>
            <span class="token operator">&lt;</span>router<span class="token operator">-</span>link to<span class="token operator">=</span><span class="token string">&quot;/sub1&quot;</span><span class="token operator">&gt;</span>子项目<span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;sub-container&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>router<span class="token operator">-</span>view <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
#app <span class="token punctuation">{</span>
    font<span class="token operator">-</span>family<span class="token operator">:</span> Avenir<span class="token punctuation">,</span> Helvetica<span class="token punctuation">,</span> Arial<span class="token punctuation">,</span> sans<span class="token operator">-</span>serif<span class="token punctuation">;</span>
    <span class="token operator">-</span>webkit<span class="token operator">-</span>font<span class="token operator">-</span>smoothing<span class="token operator">:</span> antialiased<span class="token punctuation">;</span>
    <span class="token operator">-</span>moz<span class="token operator">-</span>osx<span class="token operator">-</span>font<span class="token operator">-</span>smoothing<span class="token operator">:</span> grayscale<span class="token punctuation">;</span>
    text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> #2c3e50<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

#nav <span class="token punctuation">{</span>
    <span class="token literal-property property">padding</span><span class="token operator">:</span> 30px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

#nav a <span class="token punctuation">{</span>
    font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> #2c3e50<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

#nav a<span class="token punctuation">.</span>router<span class="token operator">-</span>link<span class="token operator">-</span>exact<span class="token operator">-</span>active <span class="token punctuation">{</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> #42b983<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>接着需要改造下main.js，执行启动函数。`</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>src<span class="token operator">/</span>main<span class="token punctuation">.</span>js

<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App.vue&quot;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&quot;./router&quot;</span>
<span class="token keyword">import</span> start <span class="token keyword">from</span> <span class="token string">&quot;./micro&quot;</span>

<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span>

instance<span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>上面有一点需要注意的是，start函数必须在DOM节点加载完成后调用，不然会报找不到容器DOM。具体可见常见问题。</p> <p>至此，我们的主应用搭建完成，接着来搭建微应用。</p> <p>微应用</p> <p>微应用不需要额外安装任何其它依赖即可接入qiankun主应用。</p> <p>1、在src目录新增public-path.js文件，用于修改运行时的publicPath。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>__POWERED_BY_QIANKUN__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  __webpack_public_path__ <span class="token operator">=</span> window<span class="token punctuation">.</span>__INJECTED_PUBLIC_PATH_BY_QIANKUN__<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2、入口文件main.js修改，这里我们需要引入刚刚新增的public-path.js文件，并导出bootstrap、mount、unmount三个生命周期钩子，以供主应用在适当的时机调用。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;./public-path&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App.vue&quot;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&quot;./router&quot;</span>

<span class="token comment">// 用于保存vue实例</span>
<span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> container <span class="token punctuation">}</span> <span class="token operator">=</span> props
  instance <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
  instance
    <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span>container <span class="token operator">?</span> container<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * bootstrap 只会在微应用初始化的时候调用一次，下次微应用重新进入时会直接调用 mount 钩子，不会再重复触发 bootstrap。
 * 通常我们可以在这里做一些全局变量的初始化，比如不会在 unmount 阶段被销毁的应用级别的缓存等。
 */</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;VueMicroApp bootstraped&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 应用每次进入都会调用 mount 方法，通常我们在这里触发应用的渲染方法
 */</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">props</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;VueMicroApp mount&quot;</span><span class="token punctuation">,</span> props<span class="token punctuation">)</span>
  <span class="token function">render</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 应用每次 切出/卸载 会调用的方法，通常在这里我们会卸载微应用的应用实例
 */</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;VueMicroApp unmount&quot;</span><span class="token punctuation">,</span> instance<span class="token punctuation">)</span>
  instance<span class="token punctuation">.</span><span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 独立运行时，直接挂载应用</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>__POWERED_BY_QIANKUN__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>这里需要注意的是为了避免根id#app与其它的DOM冲突，需要限制查找范围。如果直接使用根id则会报以下错误：</p> <p>Application died in status NOT_MOUNTED: Target container with #container not existed after xxx mounted!</p> <p>3、打包配置修改</p> <p>除了代码中暴露出相应的生命周期钩子之外，为了让主应用能正确识别微应用暴露出来的一些信息，微应用的打包工具需要增加如下配置：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 监听端口</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">8081</span><span class="token punctuation">,</span>
    <span class="token comment">// 关闭主机检查，使微应用可以被 fetch</span>
    <span class="token literal-property property">disableHostCheck</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 配置跨域请求头，解决开发环境的跨域问题</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;Access-Control-Allow-Origin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 微应用的包名，这里与主应用中注册的微应用名称一致</span>
      <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token string">&quot;sub-app1&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// 将你的 library 暴露为所有的模块定义下都可运行的方式</span>
      <span class="token literal-property property">libraryTarget</span><span class="token operator">:</span> <span class="token string">&quot;umd&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// 按需加载相关，设置为 webpackJsonp_MicroAppOrde 即可</span>
      <span class="token literal-property property">jsonpFunction</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">webpackJsonp_sub-app1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>4、修改路由</p> <p>给微应用的路由统一添加前缀，值和我们在主应用里配置的该微应用的activeRule一致。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHashHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue-router&quot;</span>

<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;sub1&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;../views/sub1.vue&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> microAppPrefix <span class="token operator">=</span> <span class="token string">&quot;/sub1&quot;</span>
<span class="token keyword">const</span> <span class="token function-variable function">setRoutesMicroAppPrefix</span> <span class="token operator">=</span> <span class="token parameter">routes</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>routes<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    routes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>path <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>microAppPrefix<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        item<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>microAppPrefix<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setRoutesMicroAppPrefix</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>__POWERED_BY_QIANKUN__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setRoutesMicroAppPrefix</span><span class="token punctuation">(</span>routes<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>微应用全部配置完成，让我们来看看效果~</p> <p>show.gif</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2022/09/07, 10:03:02</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/dd2bf3/"><div>
            缓存
            <!----></div></a> <span class="date">09-05</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/5826d5/"><div>
            http1.X与http2.0
            <!----></div></a> <span class="date">09-04</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/033241/"><div>
            面试题
            <!----></div></a> <span class="date">09-04</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2022
    <span>xiaoA</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1d277669.js" defer></script><script src="/assets/js/2.fc76d935.js" defer></script><script src="/assets/js/38.899dd51b.js" defer></script>
  </body>
</html>
